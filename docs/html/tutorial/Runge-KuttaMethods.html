
		<!DOCTYPE html>
		<html lang="en">

		<head>
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta charset="utf-8">
	

<title>Runge-Kutta Methods&mdash;Wolfram Language Documentation</title>
<meta name="buildnumber" content="0000000">
<meta name="historydata" content="{1.0.0, 1.0.0, , }" />
<meta name="keywords" content="Runge-KuttaMethods" />

<meta name="description" content="Functionality for Runge\[Dash]Kutta methods is provided under the Integreat`RK` context. This loads the Runge\[Dash]Kutta subpackage: A Runge\[Dash]Kutta method numerically approximates the solution of an initial value problem" />
<link rel="stylesheet" href="../../common/framework/css/framework.en.css"><link rel="stylesheet" href="../../common/framework/css/gui.en.css"><link rel="stylesheet" href="../../common/js/clipboard/2.0/clipboard.css"><link rel="stylesheet" href="../../fonts/source-code-pro/1.0/all.css"><link rel="stylesheet" href="../../fonts/source-sans-pro/1.0/global.css"><link rel="stylesheet" href="../../language-assets/css/entities.css"><link rel="stylesheet" href="../../language-assets/css/footer.css"><link rel="stylesheet" href="../../language-assets/css/global.css"><link rel="stylesheet" href="../../language-assets/css/guide.css"><link rel="stylesheet" href="../../language-assets/css/header-language.css"><link rel="stylesheet" href="../../language-assets/css/iconography.css"><link rel="stylesheet" href="../../language-assets/css/icons.css"><link rel="stylesheet" href="../../language-assets/css/in-out.css"><link rel="stylesheet" href="../../language-assets/css/language-specific.css"><link rel="stylesheet" href="../../language-assets/css/language.css"><link rel="stylesheet" href="../../language-assets/css/man-page.css"><link rel="stylesheet" href="../../language-assets/css/related-links.css"><link rel="stylesheet" href="../../language-assets/css/root-guide-language.css"><link rel="stylesheet" href="../../language-assets/css/special-styles.css"><link rel="stylesheet" href="../../language-assets/css/tables.css"><link rel="stylesheet" href="../../language-assets/css/technotes.css"><link rel="stylesheet" href="../../language-assets/css/tooltips.css"><link rel="stylesheet" href="../../language-assets/css/workflows.css">
<script>var baselang = 'Runge-KuttaMethods.en';</script>
</head>

<body id="techNote">
  <main class="main">
  <nav class="topContentWrap"><span class="badge">INTEGREAT TECH NOTE</span></nav><h1 class="Title main-title">Runge<span class="special-character Dash">&#8211;</span>Kutta Methods</h1><div class="TechNoteJumpBox">
  <table class="nogridboxdividers">
   <col />
   <col />
   <tr class="lineAbove" style=""><td><a href="../tutorial/Runge-KuttaMethods.html#1387781404">Basics</a></td><td><a href="../tutorial/Runge-KuttaMethods.html#696078256">Stability Analysis</a></td></tr>
   <tr class="" style=""><td><a href="../tutorial/Runge-KuttaMethods.html#115719901">Order Conditions and Error Analysis</a></td><td><a href="../tutorial/Runge-KuttaMethods.html#826483676">Extending the Runge<span class="special-character Dash">&#8211;</span>Kutta Framework</a></td></tr>
  </table>
 </div><div class="TechNoteText" id="1831283328"><a name="1831283328"></a>Functionality for Runge<span class="special-character Dash">&#8211;</span>Kutta methods is provided under the <span class="IF">Integreat`RK`</span> context.</div><div class="TechNoteMathCaption" id="2115874650"><a name="2115874650"></a>This loads the Runge<span class="special-character Dash">&#8211;</span>Kutta subpackage:</div><div id="1038421172" class="clipboard-input" data-in="In[1]:=" data-in-num="1" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_1.png" data-in-width="99" data-in-height="18" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-rgi86u" data-code="Files/Runge-KuttaMethods.en/i_1.txt" ></div><div class="TechNoteSection" id="1387781404"><a name="1387781404"></a>Basics</div><div class="TechNoteText" id="347585362"><a name="347585362"></a>A Runge<span class="special-character Dash">&#8211;</span>Kutta method numerically approximates the solution of an initial value problem</div><div class="TechNoteText"
     id="1545967842">
  <a name="1545967842"></a>
  <span class="IM"><img src="Files/Runge-KuttaMethods.en/1.png" height="23" width="293" alt="" /></span>
 </div><div class="TechNoteText" id="449380629"><a name="449380629"></a>One step of a Runge<span class="special-character Dash">&#8211;</span>Kutta method is given by</div><div class="TechNoteText"
     id="1950070479">
  <a name="1950070479"></a>
  <span class="IM"><img src="Files/Runge-KuttaMethods.en/2.png" height="48" width="235" alt="" /></span>
 </div><div class="TechNoteText" id="863439763"><a name="863439763"></a>where <span class="IM"><img src="Files/Runge-KuttaMethods.en/3.png" height="18" width="10" alt="" /></span> is the time step and <span class="IM"><img src="Files/Runge-KuttaMethods.en/4.png" height="18" width="102" alt="" /></span>. Some methods include an embedded solution to facilitate error estimation and time step adaptivity:</div><div class="TechNoteText"
     id="981751380">
  <a name="981751380"></a>
  <span class="IM"><img src="Files/Runge-KuttaMethods.en/5.png" height="25" width="237" alt="" /></span>
 </div><div class="TechNoteText" id="846183257"><a name="846183257"></a>The coefficients which determine the Runge<span class="special-character Dash">&#8211;</span>Kutta method are often displayed as a Butcher tableau:</div><div class="TechNoteText"
     id="706986410">
  <a name="706986410"></a>
  <span class="IM"><img src="Files/Runge-KuttaMethods.en/6.png" height="134" width="123" alt="" /></span>
 </div><div class="TechNoteText" id="947337016"><a name="947337016"></a>Integreat represents Runge<span class="special-character Dash">&#8211;</span>Kutta methods using the function <span class="IF"><a class="package-symbol" href="../ref/RK.html">RK</a></span>. There are a number of constructors, but some of the primary are</div><div class="MathTable DefinitionBox">
  <a name="1371133827"></a>
  <table class="nogridboxdividers">
   <col width="40%" />
   <col width="60%" />
   <tr class="lineAbove" style=""><td><a class="package-symbol" href="../ref/RK.html">RK</a><span class="openbracket">[</span><span class="TI">A</span><span class="comma">,</span><span class="TI">b</span><span class="comma">,</span><span class="TI">c</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">constructs a Runge<span class="special-character Dash">&#8211;</span>Kutta method with coefficients <span class="IF"><span class="TI">A</span></span><span class="specialcharacters"><span class="comma">,</span> </span><span class="IF"><span class="TI">b</span></span><span class="specialcharacters"><span class="comma">,</span> and </span><span class="IF"><span class="TI">c</span></span>.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RK.html">RK</a><span class="openbracket">[</span><span class="TI">A</span><span class="comma">,</span><span class="TI">b</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">constructs a Runge<span class="special-character Dash">&#8211;</span>Kutta method with <span class="IF"><span class="TI">c</span></span> coefficients that are the row sum of <span class="IF"><span class="TI">A</span></span>.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RK.html">RK</a><span class="openbracket">[</span><span class="TI">A</span><span class="comma">,</span><span class="TI">b</span><span class="comma">,</span><span class="TI">c</span><span class="comma">,</span><span class="TI">bHat</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">constructs an embedded Runge<span class="special-character Dash">&#8211;</span>Kutta pair.</div></td></tr>
  </table>
 </div><div class="TechNoteCaption" id="939981373"><a name="939981373"></a>Creating a Runge<span class="special-character Dash">&#8211;</span>Kutta method.</div><div class="TechNoteMathCaption" id="1410446557"><a name="1410446557"></a>This creates Heun's method with forward Euler used as the embedding.</div><div id="940680396" class="clipboard-input" data-in="In[2]:=" data-in-num="2" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_2.png" data-in-width="165" data-in-height="35" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-pucbxa" data-code="Files/Runge-KuttaMethods.en/i_2.txt" ></div><div class="clipboard-output" data-out="Out[2]=" data-out-num="2" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_1.png" data-out-width="33" data-out-height="73" ></div><div class="TechNoteText" id="1438465034"><a name="1438465034"></a>Once a Runge<span class="special-character Dash">&#8211;</span>Kutta method is constructed, a wide range of properties can be queried. We start by showing how to recover the defining coefficients.</div><div class="MathTable DefinitionBox">
  <a name="1461078451"></a>
  <table class="nogridboxdividers">
   <col width="40%" />
   <col width="60%" />
   <tr class="lineAbove" style=""><td><a class="package-symbol" href="../ref/RKA.html">RKA</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">gives the <span class="IM"><img src="Files/Runge-KuttaMethods.en/7.png" height="20" width="10" alt="" /></span> coefficients of the Runge<span class="special-character Dash">&#8211;</span>Kutta method <span class="IF"><span class="TI">rk</span></span>.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RKB.html">RKB</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">gives the <span class="IM"><img src="Files/Runge-KuttaMethods.en/8.png" height="20" width="10" alt="" /></span> coefficients of the Runge<span class="special-character Dash">&#8211;</span>Kutta method <span class="IF"><span class="TI">rk</span></span>.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RKC.html">RKC</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">gives the <span class="IM"><img src="Files/Runge-KuttaMethods.en/9.png" height="20" width="8" alt="" /></span> coefficients of the Runge<span class="special-character Dash">&#8211;</span>Kutta method <span class="IF"><span class="TI">rk</span></span>.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RKBHat.html">RKBHat</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">gives the embedded coefficients of an embedded Runge<span class="special-character Dash">&#8211;</span>Kutta pair <span class="IF"><span class="TI">rk</span></span>.</div></td></tr>
  </table>
 </div><div class="TechNoteCaption" id="1552889992"><a name="1552889992"></a>Access method coefficients.</div><div class="TechNoteMathCaption" id="662115214"><a name="662115214"></a>Extract the coefficients from an embedded pair.</div><div id="253576177" class="clipboard-input" data-in="In[3]:=" data-in-num="3" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_3.png" data-in-width="95" data-in-height="92" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-eg9awz" data-code="Files/Runge-KuttaMethods.en/i_3.txt" ></div><div class="clipboard-output" data-out="Out[3]=" data-out-num="3" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_2.png" data-out-width="64" data-out-height="137" ></div><div class="clipboard-output" data-out="Out[4]=" data-out-num="4" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_3.png" data-out-width="257" data-out-height="30" ></div><div class="clipboard-output" data-out="Out[5]=" data-out-num="5" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_4.png" data-out-width="64" data-out-height="30" ></div><div class="clipboard-output" data-out="Out[6]=" data-out-num="6" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_5.png" data-out-width="61" data-out-height="29" ></div><div class="clipboard-output" data-out="Out[7]=" data-out-num="7" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_6.png" data-out-width="73" data-out-height="30" ></div><div class="TechNoteText" id="1807492312"><a name="1807492312"></a>There are three options defined for <span class="IF"><a class="package-symbol" href="../ref/RKB.html">RKB</a></span> which play a core role in Integreat's support for advanced features like embedded methods, dense output, and per-stage properties.</div><div class="MathTable DefinitionBox3Col">
  <a name="860155295"></a>
  <table class="nogridboxdividers">
   <col width="35%" />
   <col width="20%" />
   <col width="45%" />
   <tr class="lineAbove" style=""><td>Embedded</td><td>False</td><td><div class="TechNoteTableText">whether to return the embedded coefficients</div></td></tr>
   <tr class="" style=""><td>Stage</td><td>None</td><td><div class="TechNoteTableText">treat a stage as the solution</div></td></tr>
   <tr class="" style=""><td>DenseOutput</td><td>False</td><td><div class="TechNoteTableText">how to evaluate dense output</div></td></tr>
  </table>
 </div><div class="TechNoteCaption" id="132978287"><a name="132978287"></a>Options for <span class="IF"><a class="package-symbol" href="../ref/RKB.html">RKB</a></span>.</div><div class="TechNoteMathCaption" id="1776438505"><a name="1776438505"></a>Use options for <span class="IF"><a class="package-symbol" href="../ref/RKB.html">RKB</a></span>.</div><div id="1032455414" class="clipboard-input" data-in="In[8]:=" data-in-num="8" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_4.png" data-in-width="203" data-in-height="126" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-rczdzc" data-code="Files/Runge-KuttaMethods.en/i_4.txt" ></div><div class="clipboard-output" data-out="Out[8]=" data-out-num="8" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_7.png" data-out-width="34" data-out-height="88" ></div><div class="clipboard-output" data-out="Out[9]=" data-out-num="9" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_8.png" data-out-width="26" data-out-height="16" ></div><div class="clipboard-output" data-out="Out[10]=" data-out-num="10" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_9.png" data-out-width="34" data-out-height="29" ></div><div class="clipboard-output" data-out="Out[11]=" data-out-num="11" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_10.png" data-out-width="38" data-out-height="29" ></div><div class="clipboard-output" data-out="Out[12]=" data-out-num="12" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_11.png" data-out-width="44" data-out-height="16" ></div><div class="TechNoteText" id="823121912"><a name="823121912"></a>Whenever appropriate, functions for computing Runge<span class="special-character Dash">&#8211;</span>Kutta properties use the same options as <span class="IF"><a class="package-symbol" href="../ref/RKB.html">RKB</a></span>. This facilitates, for example, plotting the stability region of an embedded method, generating the order conditions for a dense output solution, and checking the dissipation error of a particular Runge<span class="special-character Dash">&#8211;</span>Kutta stage. In the next sections, we will explore some of these capabilities.</div><div class="TechNoteSection" id="115719901"><a name="115719901"></a>Order Conditions and Error Analysis</div><div class="TechNoteText" id="1278935759"><a name="1278935759"></a>Deriving order conditions for Runge<span class="special-character Dash">&#8211;</span>Kutta methods by hand is a notoriously tedious and error-prone. Integreat uses B-trees to automate and simplify this process.</div><div class="MathTable DefinitionBox">
  <a name="248464571"></a>
  <table class="nogridboxdividers">
   <col width="40%" />
   <col width="60%" />
   <tr class="lineAbove" style=""><td><a class="package-symbol" href="../ref/RKOrderConditions.html">RKOrderConditions</a><span class="openbracket">[</span><span class="TI">rk</span><span class="comma">,</span><span class="TI">p</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">generates the order condition residuals of <span class="IF"><span class="TI">rk</span></span> up to order <span class="IF"><span class="TI">p</span></span> grouped by order.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RKOrder.html">RKOrder</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">computes the order of accuracy of <span class="IF"><span class="TI">rk</span></span>.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RKErrorA.html">RKErrorA</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">computes the 2-norm of the principal error residuals of <span class="IF"><span class="TI">rk</span></span>.</div></td></tr>
  </table>
 </div><div class="TechNoteCaption" id="1152060211"><a name="1152060211"></a>Select functions for order conditions.</div><div class="TechNoteMathCaption" id="1498317186"><a name="1498317186"></a>Generate order conditions for a two stage Runge<span class="special-character Dash">&#8211;</span>Kutta method.</div><div id="1883141685" class="clipboard-input" data-in="In[13]:=" data-in-num="13" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_5.png" data-in-width="142" data-in-height="37" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-5fgjpj" data-code="Files/Runge-KuttaMethods.en/i_5.txt" ></div><div class="clipboard-output" data-out="Out[13]=" data-out-num="13" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_12.png" data-out-width="57" data-out-height="51" ></div><div class="clipboard-output" data-out="Out[14]=" data-out-num="14" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_13.png" data-out-width="528" data-out-height="30" ></div><div class="TechNoteMathCaption" id="1163925152"><a name="1163925152"></a>Find the order of an embedded method.</div><div id="727426001" class="clipboard-input" data-in="In[15]:=" data-in-num="15" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_6.png" data-in-width="176" data-in-height="37" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-mbdjr3" data-code="Files/Runge-KuttaMethods.en/i_6.txt" ></div><div class="clipboard-output" data-out="Out[15]=" data-out-num="15" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_14.png" data-out-width="64" data-out-height="137" ></div><div class="clipboard-output" data-out="Out[16]=" data-out-num="16" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_15.png" data-out-width="7" data-out-height="16" ></div><div class="TechNoteText" id="1022778219"><a name="1022778219"></a>Once order conditions are generated, functions like <span class="IF"><a href="http://reference.wolfram.com/language/ref/Solve.html">Solve</a></span> and <span class="IF"><a href="http://reference.wolfram.com/language/ref/SolveAlways.html">SolveAlways</a></span> can be used to find solutions. The parameterization of a method plays a significant role in how well these functions perform. We demonstrate this in the next two examples where we seek a family of explicit, third order Runge<span class="special-character Dash">&#8211;</span>Kutta methods.</div><div class="TechNoteMathCaption" id="250931701"><a name="250931701"></a>This parameterization of a Runge<span class="special-character Dash">&#8211;</span>Kutta method leads to complicated solutions with branching.</div><div id="1744754352" class="clipboard-input" data-in="In[17]:=" data-in-num="17" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_7.png" data-in-width="263" data-in-height="73" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-242fcy" data-code="Files/Runge-KuttaMethods.en/i_7.txt" ></div><div class="clipboard-output" data-out="Out[17]=" data-out-num="17" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_16.png" data-out-width="109" data-out-height="68" ></div><div class="clipboard-output" data-out="Out[18]=" data-out-num="18" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_17.png" data-out-width="510" data-out-height="156" ></div><div class="TechNoteMathCaption" id="1372157793"><a name="1372157793"></a>Here, the method is parameterized so that the row sum of <span class="IM"><img src="Files/Runge-KuttaMethods.en/10.png" height="17" width="10" alt="" /></span> is <span class="IM"><img src="Files/Runge-KuttaMethods.en/11.png" height="17" width="8" alt="" /></span>. When invoking <span class="IF"><a href="http://reference.wolfram.com/language/ref/Solve.html">Solve</a></span>, the abscissae are left as free variables. We recommend this approach as it generally provides simpler and faster solutions.</div><div id="236267403" class="clipboard-input" data-in="In[19]:=" data-in-num="19" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_8.png" data-in-width="322" data-in-height="108" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-d6ybdp" data-code="Files/Runge-KuttaMethods.en/i_8.txt" ></div><div class="clipboard-output" data-out="Out[19]=" data-out-num="19" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_18.png" data-out-width="95" data-out-height="66" ></div><div class="clipboard-output" data-out="Out[21]=" data-out-num="21" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_19.png" data-out-width="455" data-out-height="43" ></div><div class="TechNoteText" id="741544492"><a name="741544492"></a>With order conditions solved, free variables can be used to optimize other properties of the method. One common approach is minimizing the principal error.</div><div class="TechNoteMathCaption" id="531348057"><a name="531348057"></a>Find the explicit, third order Runge<span class="special-character Dash">&#8211;</span>Kutta method with the smallest error:</div><div id="844584107" class="clipboard-input" data-in="In[23]:=" data-in-num="23" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_9.png" data-in-width="241" data-in-height="37" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-n84njx" data-code="Files/Runge-KuttaMethods.en/i_9.txt" ></div><div class="clipboard-output" data-out="Out[23]=" data-out-num="23" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_20.png" data-out-width="315" data-out-height="36" ></div><div class="clipboard-output" data-out="Out[24]=" data-out-num="24" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_21.png" data-out-width="47" data-out-height="87" ></div><div class="TechNoteSection" id="696078256"><a name="696078256"></a>Stability Analysis</div><div class="TechNoteText" id="271024715"><a name="271024715"></a>Linear stability analysis considers the behavior of a Runge<span class="special-character Dash">&#8211;</span>Kutta method applied to the Dahlquist test problem <span class="IM"><img src="Files/Runge-KuttaMethods.en/12.png" height="18" width="52" alt="" /></span>. The numerical solution for this problem is <span class="IM"><img src="Files/Runge-KuttaMethods.en/13.png" height="18" width="91" alt="" /></span>, where</div><div class="TechNoteText"
     id="1423990455">
  <a name="1423990455"></a>
  <span class="IM"><img src="Files/Runge-KuttaMethods.en/14.png" height="24" width="168" alt="" /></span>
 </div><div class="TechNoteText" id="507208642"><a name="507208642"></a>is the linear stability function and <span class="IM"><img src="Files/Runge-KuttaMethods.en/15.png" height="18" width="48" alt="" /></span>. The set of <span class="IM">z<span class="special-character Element">&#8712;</span><img src="Files/Runge-KuttaMethods.en/16.png" height="18" width="11" alt="" /></span> for which <span class="IM"><img src="Files/Runge-KuttaMethods.en/19.png" height="18" width="62" alt="" /></span> is known as the region of absolute stability. The size of the stability region determines the range of stable time steps a Runge<span class="special-character Dash">&#8211;</span>Kutta method can take.</div><div class="MathTable DefinitionBox">
  <a name="1615485131"></a>
  <table class="nogridboxdividers">
   <col width="40%" />
   <col width="60%" />
   <tr class="lineAbove" style=""><td><a class="package-symbol" href="../ref/RKLinearStability.html">RKLinearStability</a><span class="openbracket">[</span><span class="TI">rk</span><span class="comma">,</span><span class="TI">z</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">evaluates the linear stability function of <span class="IF"><span class="TI">rk</span></span> at <span class="IF"><span class="TI">z</span></span>.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RKLinearStabilityPlot.html">RKLinearStabilityPlot</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">plots the linear stability region of <span class="IF"><span class="TI">rk</span></span>.</div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RKAStable.html">RKAStable</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">returns an algebraic condition equivalent to <span class="IF"><span class="TI">rk</span></span> being stable in the left half-plane.</div></td></tr>
  </table>
 </div><div class="TechNoteCaption" id="1340532434"><a name="1340532434"></a>Select functions for linear stability analysis.</div><div class="TechNoteMathCaption" id="1490698978"><a name="1490698978"></a>Check linear stability properties of the classical fourth order Runge<span class="special-character Dash">&#8211;</span>Kutta method.</div><div id="1635044452" class="clipboard-input" data-in="In[25]:=" data-in-num="25" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_10.png" data-in-width="188" data-in-height="74" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-1bqynq" data-code="Files/Runge-KuttaMethods.en/i_10.txt" ></div><div class="clipboard-output" data-out="Out[25]=" data-out-num="25" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_22.png" data-out-width="59" data-out-height="104" ></div><div class="clipboard-output" data-out="Out[26]=" data-out-num="26" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_23.png" data-out-width="95" data-out-height="33" ></div><div class="clipboard-output" data-out="Out[27]=" data-out-num="27" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_24.png" data-out-width="238" data-out-height="241" ></div><div class="clipboard-output" data-out="Out[28]=" data-out-num="28" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_25.png" data-out-width="27" data-out-height="16" ></div><div class="TechNoteText" id="2004110226"><a name="2004110226"></a>Integreat also include nonlinear stability analysis capabilities.</div><div class="MathTable DefinitionBox">
  <a name="1220808148"></a>
  <table class="nogridboxdividers">
   <col width="40%" />
   <col width="60%" />
   <tr class="lineAbove" style=""><td><a class="package-symbol" href="../ref/RKAlgebraicallyStableQ.html">RKAlgebraicallyStableQ</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText">returns <span class="IF"><a href="http://reference.wolfram.com/language/ref/True.html">True</a></span> if <span class="IF"><span class="TI">rk</span></span> is algebraically stable and <span class="IF"><a href="http://reference.wolfram.com/language/ref/False.html">False</a></span><span class="specialcharacters"><span class="comma">,</span> otherwise.</span></div></td></tr>
   <tr class="" style=""><td><a class="package-symbol" href="../ref/RKAbsoluteMonotonicityRadius.html">RKAbsoluteMonotonicityRadius</a><span class="openbracket">[</span><span class="TI">rk</span><span class="closebracket">]</span></td><td><div class="TechNoteTableText"><span class="specialcharacters">computes the radius of absolute monotonicity<span class="comma">,</span> also known as the strong stability preserving <span class="openparenthesis">(</span>SSP<span class="closeparenthesis">)</span> coefficient<span class="comma">,</span> of </span><span class="IF"><span class="TI">rk</span></span>.</div></td></tr>
  </table>
 </div><div class="TechNoteCaption" id="861369612"><a name="861369612"></a>Select functions for nonlinear stability analysis.</div><div class="TechNoteMathCaption" id="1746805755"><a name="1746805755"></a>Check nonlinear stability properties of a collocation method.</div><div id="2118671121" class="clipboard-input" data-in="In[29]:=" data-in-num="29" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/I_11.png" data-in-width="376" data-in-height="55" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-9bordv" data-code="Files/Runge-KuttaMethods.en/i_11.txt" ></div><div class="clipboard-output" data-out="Out[29]=" data-out-num="29" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_26.png" data-out-width="33" data-out-height="63" ></div><div class="clipboard-output" data-out="Out[30]=" data-out-num="30" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_27.png" data-out-width="27" data-out-height="16" ></div><div class="clipboard-output" data-out="Out[31]=" data-out-num="31" data-out-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="Files/Runge-KuttaMethods.en/O_28.png" data-out-width="85" data-out-height="67" ></div><div class="TechNoteSection" id="826483676"><a name="826483676"></a>Extending the Runge<span class="special-character Dash">&#8211;</span>Kutta Framework</div><div class="TechNoteText" id="2127484173"><a name="2127484173"></a>Advanced users may need to create custom functions to analyze Runge<span class="special-character Dash">&#8211;</span>Kutta methods. The patterns <span class="IF">_RK</span> and <span class="IF">_?RKPairQ</span> can be used to accept an <span class="IF"><a class="package-symbol" href="../ref/RK.html">RK</a></span> object as a function argument. If a custom function uses the <span class="IM"><img src="Files/Runge-KuttaMethods.en/20.png" height="18" width="10" alt="" /></span> coefficients of a method, it probably should accept <span class="IF"><a class="package-symbol" href="../ref/RKB.html">RKB</a></span> options.</div><div class="TechNoteMathCaption" id="2039721373"><a name="2039721373"></a>A custom function to generate linear order condition residuals.</div><div id="1005984223" class="clipboard-input" data-in="In[32]:=" data-in-num="32" data-in-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src-swap="Files/Runge-KuttaMethods.en/I_12.png" data-big="409 37" data-small="409 37" data-link="https://wolfram.com/xid/0vithi0d9w3y71ckuthxx4lselln4-qw70oh" data-code="Files/Runge-KuttaMethods.en/i_12.txt" ></div><section id="RelatedGuides" class="related-links"><div class="inner">
   <h1>Related Guides</h1>
   <ul class="functionList">
    <span class="special-character FilledVerySmallSquare">&#9642;</span>
    <li>
     <a href="../guide/IntegreatPackage.html">Integreat Package</a>
    </li>
    <span class="special-character FilledVerySmallSquare">&#9642;</span>
    <li>
     <a href="../guide/Runge-KuttaMethods.html">Runge<span class="special-character Dash">&#8211;</span>Kutta Methods</a>
    </li>
    <span class="special-character FilledVerySmallSquare">&#9642;</span>
    <li>
     <a href="../guide/LinearMultistepMethods.html">Linear Multistep Methods</a>
    </li>
    <span class="special-character FilledVerySmallSquare">&#9642;</span>
    <li>
     <a href="../guide/GeneralLinearMethods.html">General Linear Methods</a>
    </li>
   </ul>
  </div></section><section id="RelatedTutorials" class="related-links"><div class="inner">
   <h1>Related Tech Notes</h1>
   <ul class="functionList">
    <span class="special-character FilledVerySmallSquare">&#9642;</span>
    <li>
     <a href="../tutorial/IntegreatPackage.html">Integreat Package</a>
    </li>
    <span class="special-character FilledVerySmallSquare">&#9642;</span>
    <li>
     <a href="../tutorial/LinearMultistepMethods.html">Linear Multistep Methods</a>
    </li>
    <span class="special-character FilledVerySmallSquare">&#9642;</span>
    <li>
     <a href="../tutorial/GeneralLinearMethods.html">General Linear Methods</a>
    </li>
   </ul>
  </div></section>
  

  
		</main>
		<div id="_footer-offset"></div>
		<div id="_footer"></div>
		<script src="../../common/js/jquery/2.2.4/jquery.min.js"></script><script src="../../common/js/jquery/plugins/hoverintent/1.8.0/hoverintent.min.j2"></script><script src="../../common/js/clipboard/2.0/clipboard.js"></script><script src="../../common/js/clipboard/2.0/code-clipboard.js"></script><script src="../../common/framework/js/body.en.js"></script><script src="../../common/framework/js/head.en.js"></script><script src="../../language-assets/js/dropdowns.js"></script><script src="../../language-assets/js/global.js"></script><script src="../../language-assets/js/language-specific.js.en"></script><script src="../../language-assets/js/language.js"></script><script src="../../language-assets/js/temporary.js"></script><script src="../../language-assets/js/toggles.js"></script><script src="../../language-assets/js/tooltips.js"></script><script src="../../language-assets/js/workflows.js"></script>
</body>
</html>